
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>附錄：建立資料表與插入資料教學</title>
    <style>
        body { font-family: "Noto Sans TC", "Microsoft JhengHei", sans-serif; margin: 2rem; line-height: 1.7; }
        h1, h2 { color: #2c3e50; }
        pre, code { background: #f4f4f4; padding: 0.75rem; display: block; border-radius: 6px; overflow-x: auto; }
        table { border-collapse: collapse; width: 100%; margin-top: 1rem; }
        th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }
        th { background-color: #f0f0f0; }
    </style>
</head>
<body>
    <h1>附錄：建立資料表與插入資料教學</h1>

    <h2>建立 products 商品資料表</h2>
    <pre><code>CREATE TABLE products (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50),
    price DECIMAL(10,2)
);</code></pre>

    <h2>建立 customers 顧客資料表</h2>
    <pre><code>CREATE TABLE customers (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50),
    email VARCHAR(100)
);</code></pre>

    <h2>建立 orders 訂單資料表（含外鍵）</h2>
    <pre><code>CREATE TABLE orders (
    id INT PRIMARY KEY AUTO_INCREMENT,
    customer_id INT,
    product_id INT,
    quantity INT,
    FOREIGN KEY (customer_id) REFERENCES customers(id) ON DELETE RESTRICT,
    FOREIGN KEY (product_id) REFERENCES products(id) ON DELETE RESTRICT
);</code></pre>

    <h2>插入範例資料</h2>
    <pre><code>INSERT INTO products (name, price) VALUES 
('可樂', 25.00),
('泡麵', 35.00),
('麵包', 20.00);

INSERT INTO customers (name, email) VALUES 
('小明', 'ming@example.com'),
('小美', 'mei@example.com');

INSERT INTO orders (customer_id, product_id, quantity) VALUES
(1, 2, 3),
(2, 1, 1),
(1, 1, 2);</code></pre>

    <h2>補充說明</h2>
    <ul>
        <li><strong>AUTO_INCREMENT</strong>：讓 id 自動遞增。</li>
        <li><strong>FOREIGN KEY</strong>：建立資料關聯，限制訂單的 customer_id 必須來自 customers 表。</li>
        <li><strong>ON DELETE RESTRICT</strong>：若有訂單，不能刪除顧客或商品。</li>
    </ul>

    <h2>補充：ON DELETE 行為說明（RESTRICT vs CASCADE）</h2>
    <p><strong>RESTRICT</strong>：若子表有關聯資料，禁止刪除父表資料（預設）</p>
    <p><strong>CASCADE</strong>：刪除父表資料時，自動刪除所有子表關聯資料</p>

    <h3>RESTRICT 範例：</h3>
    <pre><code>CREATE TABLE orders (
    ...
    FOREIGN KEY (customer_id) REFERENCES customers(id) ON DELETE RESTRICT
);</code></pre>
    <p>嘗試執行 <code>DELETE FROM customers WHERE id = 1;</code> 時會失敗。</p>

    <h3>CASCADE 範例：</h3>
    <pre><code>CREATE TABLE orders (
    ...
    FOREIGN KEY (customer_id) REFERENCES customers(id) ON DELETE CASCADE
);</code></pre>
    <p>執行 <code>DELETE FROM customers WHERE id = 1;</code> 時，會自動連帶刪除對應訂單。</p>

    <table>
        <tr><th>模式</th><th>有訂單時是否可刪顧客</th><th>結果</th></tr>
        <tr><td>RESTRICT</td><td>❌ 不可刪</td><td>阻止誤刪，保留資料一致性</td></tr>
        <tr><td>CASCADE</td><td>✅ 可刪</td><td>同時自動刪除對應的訂單</td></tr>
    </table>

</body>
</html>
